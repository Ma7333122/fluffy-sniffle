<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù†Ø¸Ø§Ù… Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</title>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.2/dist/jspdf.plugin.autotable.min.js"></script>
  <style>
    :root {
      --primary: #2c3e50;
      --secondary: #3498db;
      --accent: #e74c3c;
      --light: #ecf0f1;
      --dark: #2c3e50;
      --success: #27ae60;
      --warning: #f39c12;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      direction: rtl;
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      color: var(--dark);
      line-height: 1.6;
      padding: 15px;
      min-height: 100vh;
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø±ÙƒØ§Øª */
    .company-badge {
      display: inline-block;
      padding: 4px 12px;
      background: var(--secondary);
      color: white;
      border-radius: 12px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-right: 8px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    header {
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      border: 1px solid rgba(52, 152, 219, 0.1);
    }
    
    .logo-section {
      display: flex;
      align-items: center;
    }
    
    .logo {
      width: 60px;
      height: 60px;
      background: var(--secondary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 20px;
      margin-left: 12px;
    }
    
    .company-info {
      flex-grow: 1;
    }
    
    .company-info h1 {
      color: var(--primary);
      margin-bottom: 3px;
      border: 1px dashed transparent;
      padding: 4px;
      border-radius: 4px;
      font-size: 1.4rem;
    }
    
    .company-info h1:focus {
      border-color: var(--secondary);
      outline: none;
    }
    
    .company-info p {
      color: #666;
      border: 1px dashed transparent;
      padding: 2px;
      border-radius: 4px;
      margin-bottom: 2px;
      font-size: 0.9rem;
    }
    
    .company-info p:focus {
      border-color: var(--secondary);
      outline: none;
    }
    
    .invoice-header {
      text-align: left;
    }
    
    .invoice-header h2 {
      color: var(--primary);
      margin-bottom: 8px;
      font-size: 1.3rem;
    }
    
    .tabs {
      display: flex;
      background: white;
      border-radius: 8px 8px 0 0;
      overflow: hidden;
      box-shadow: var(--shadow);
    }
    
    .tab {
      padding: 12px 20px;
      cursor: pointer;
      background: #f8f9fa;
      border: none;
      flex: 1;
      text-align: center;
      font-weight: bold;
      transition: all 0.3s;
      font-size: 0.9rem;
    }
    
    .tab.active {
      background: var(--secondary);
      color: white;
    }
    
    .tab:hover:not(.active) {
      background: #e9ecef;
    }
    
    .tab-content {
      display: none;
      background: white;
      padding: 20px;
      border-radius: 0 0 8px 8px;
      box-shadow: var(--shadow);
      margin-bottom: 15px;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .section {
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }
    
    .section:last-child {
      border-bottom: none;
    }
    
    .section-title {
      color: var(--primary);
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--secondary);
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.1rem;
    }
    
    .form-group {
      margin-bottom: 12px;
    }
    
    label {
      display: block;
      margin-bottom: 4px;
      font-weight: 600;
      color: #555;
      font-size: 0.9rem;
    }
    
    input[type="text"],
    input[type="number"],
    input[type="date"],
    input[type="email"],
    select,
    textarea {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 0.9rem;
      transition: border 0.3s;
    }
    
    input:focus,
    select:focus,
    textarea:focus {
      border-color: var(--secondary);
      outline: none;
      box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.05);
    }
    
    th, td {
      border: 1px solid #ddd;
      padding: 10px 6px;
      text-align: center;
      font-size: 0.85rem;
    }
    
    th {
      background-color: var(--primary);
      color: white;
      font-weight: 600;
    }
    
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    
    tr:hover {
      background-color: #f1f1f1;
    }
    
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    
    .btn-primary {
      background: var(--secondary);
      color: white;
    }
    
    .btn-primary:hover {
      background: #2980b9;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .btn-success {
      background: var(--success);
      color: white;
    }
    
    .btn-success:hover {
      background: #219653;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .btn-danger {
      background: var(--accent);
      color: white;
    }
    
    .btn-danger:hover {
      background: #c0392b;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .btn-info {
      background: #17a2b8;
      color: white;
    }
    
    .btn-info:hover {
      background: #138496;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    
    .btn-outline {
      background: transparent;
      border: 2px solid var(--secondary);
      color: var(--secondary);
    }
    
    .btn-outline:hover {
      background: var(--secondary);
      color: white;
    }
    
    .action-buttons {
      display: flex;
      gap: 8px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    
    .totals-section {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 6px;
      margin-top: 15px;
    }
    
    .total-row {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #dee2e6;
    }
    
    .total-row:last-child {
      border-bottom: none;
      font-weight: bold;
      font-size: 1rem;
      color: var(--primary);
    }
    
    .delete-btn {
      background: transparent;
      border: none;
      color: var(--accent);
      cursor: pointer;
      font-size: 16px;
    }
    
    .notification {
      position: fixed;
      top: 15px;
      left: 15px;
      padding: 12px 20px;
      border-radius: 4px;
      color: white;
      font-weight: 600;
      z-index: 1000;
      opacity: 0;
      transform: translateY(-20px);
      transition: all 0.3s;
      font-size: 0.9rem;
    }
    
    .notification.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    .notification.success {
      background: var(--success);
    }
    
    .notification.error {
      background: var(--accent);
    }
    
    .theme-selector {
      display: flex;
      gap: 8px;
      margin-top: 8px;
      flex-wrap: wrap;
    }
    
    .theme-option {
      width: 35px;
      height: 35px;
      border-radius: 4px;
      cursor: pointer;
      border: 2px solid transparent;
    }
    
    .theme-option.active {
      border-color: var(--dark);
    }
    
    .template-selector {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 12px;
      margin-top: 12px;
    }
    
    .template-option {
      border: 2px solid #ddd;
      border-radius: 6px;
      padding: 12px;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
    }
    
    .template-option.active {
      border-color: var(--secondary);
      background-color: rgba(52, 152, 219, 0.1);
    }
    
    .template-option:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow);
    }
    
    .template-preview {
      height: 100px;
      background: #f8f9fa;
      border-radius: 4px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
      color: #666;
    }
    
    .invoice-preview {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
      margin-top: 20px;
      width: 210mm; /* Ø­Ø¬Ù… A4 Ø¹Ù…ÙˆØ¯ÙŠ */
      min-height: 297mm;
      margin: 20px auto;
      border: 1px solid rgba(0, 0, 0, 0.05);
      page-break-after: always;
    }
    
    .invoice-preview.landscape {
      width: 297mm; /* Ø­Ø¬Ù… A4 Ø£ÙÙ‚ÙŠ */
      min-height: 210mm;
    }
    
    .page-break {
      page-break-after: always;
      break-after: page;
    }
    
    .invoice-header-preview {
      display: flex;
      justify-content: space-between;
      margin-bottom: 25px;
      border-bottom: 2px solid #eee;
      padding-bottom: 15px;
    }
    
    .invoice-details-preview {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 25px;
    }
    
    .invoice-items-preview table {
      width: 100%;
      margin-bottom: 25px;
    }
    
    .invoice-totals-preview {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-top: 25px;
    }
    
    .print-only {
      display: none;
    }
    
    .hidden-section {
      display: none;
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
    @media print {
      @page {
        size: A4;
        margin: 0;
      }
      
      body {
        background: white;
        padding: 0;
        margin: 0;
      }
      
      .no-print {
        display: none !important;
      }
      
      .container {
        max-width: 100%;
        margin: 0;
        padding: 0;
      }
      
      .invoice-preview {
        width: 210mm;
        min-height: 297mm;
        max-height: 297mm;
        margin: 0;
        padding: 15mm;
        box-shadow: none;
        border-radius: 0;
        page-break-after: always;
        overflow: hidden;
      }
      
      .invoice-preview.landscape {
        width: 297mm;
        min-height: 210mm;
        max-height: 210mm;
      }
      
      .print-only {
        display: block;
      }
      
      /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ· Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© */
      * {
        font-family: 'Arial', sans-serif !important;
      }
      
      /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± ØºÙŠØ± Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠØ© ÙÙŠ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© */
      .tab-content:not(.active),
      header,
      .quick-actions,
      .tabs,
      .action-buttons {
        display: none !important;
      }
    }
    
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        text-align: center;
      }
      
      .logo-section {
        margin-bottom: 12px;
        justify-content: center;
      }
      
      .tabs {
        flex-direction: column;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
        margin-bottom: 8px;
      }
      
      table {
        display: block;
        overflow-x: auto;
      }
      
      .invoice-preview {
        width: 100%;
        padding: 15px;
      }
      
      .invoice-details-preview,
      .invoice-totals-preview {
        grid-template-columns: 1fr;
      }
      
      .template-selector {
        grid-template-columns: 1fr;
      }
    }
    
    /* ØªØµÙ…ÙŠÙ…Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
    .invoice-template-modern {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      border: 2px solid #3498db;
    }
    
    .invoice-template-classic {
      font-family: Georgia, 'Times New Roman', Times, serif;
      border: 2px solid #2c3e50;
    }
    
    .invoice-template-minimal {
      font-family: Arial, Helvetica, sans-serif;
      border: 1px solid #ddd;
    }
    
    .invoice-template-colorful {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      border: 2px solid #e74c3c;
    }
    
    .invoice-template-professional {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      border: 2px solid #27ae60;
    }
    
    .quick-actions {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }
    
    .quick-action-btn {
      padding: 8px 15px;
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.85rem;
      transition: all 0.2s;
    }
    
    .quick-action-btn:hover {
      background: #e9ecef;
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ø´Ø±ÙƒØ§Øª */
    .section-title {
      position: relative;
    }
    
    .section-title::before {
      content: '';
      position: absolute;
      right: 0;
      bottom: -2px;
      width: 60px;
      height: 3px;
      background: var(--secondary);
      border-radius: 2px;
    }
    
    input[type="text"]:focus,
    input[type="number"]:focus,
    input[type="date"]:focus,
    input[type="email"]:focus,
    select:focus,
    textarea:focus {
      border-color: var(--secondary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
      transform: translateY(-1px);
      transition: all 0.3s ease;
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ */
    .editable-cell {
      transition: all 0.2s;
    }
    
    .editable-cell:focus {
      background-color: #f8f9fa;
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    .loading {
      opacity: 0.7;
      pointer-events: none;
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© */
    .image-saving {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      color: white;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <div class="container no-print">
    <header>
      <div class="logo-section">
        <div class="logo" id="companyLogo">Ø´</div>
        <div class="company-info">
          <h1 contenteditable="true" id="companyName">Ø´Ø±ÙƒØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø©</h1>
          <p contenteditable="true" id="companyDescription">ÙˆØµÙ Ø´Ø±ÙƒØªÙƒ ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§</p>
          <p contenteditable="true" id="companyAddress">Ø¹Ù†ÙˆØ§Ù† Ø´Ø±ÙƒØªÙƒ</p>
          <p contenteditable="true" id="companyContact">Ù‡Ø§ØªÙ: 0123456789 | Ø§Ù„Ø¨Ø±ÙŠØ¯: info@company.com</p>
        </div>
      </div>
      <div class="invoice-header">
        <h2>Ù†Ø¸Ø§Ù… Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…ØªÙ‚Ø¯Ù… <span class="company-badge">PRO</span></h2>
        <p>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©: <strong id="invoiceNumberDisplay">INV-2023-001</strong></p>
      </div>
    </header>
    
    <div class="quick-actions">
      <button class="quick-action-btn" onclick="addRow()">â• Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯</button>
      <button class="quick-action-btn" onclick="duplicateLastRow()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø£Ø®ÙŠØ±</button>
      <button class="quick-action-btn" onclick="clearAllRows()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
      <button class="quick-action-btn" onclick="fillSampleData()">ğŸ”„ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©</button>
    </div>
    
    <div class="tabs">
      <button class="tab active" onclick="openTab('client-tab', this)">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</button>
      <button class="tab" onclick="openTab('items-tab', this)">Ø§Ù„Ø¨Ù†ÙˆØ¯</button>
      <button class="tab" onclick="openTab('payment-tab', this)">Ø§Ù„Ø¯ÙØ¹ ÙˆØ§Ù„Ø´Ø­Ù†</button>
      <button class="tab" onclick="openTab('design-tab', this)">Ø§Ù„ØªØµÙ…ÙŠÙ…</button>
      <button class="tab" onclick="openTab('preview-tab', this)">Ù…Ø¹Ø§ÙŠÙ†Ø©</button>
    </div>
    
    <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
    <div id="client-tab" class="tab-content active">
      <div class="section">
        <h3 class="section-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h3>
        <div class="form-group">
          <label for="clientName">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
          <input type="text" id="clientName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„" oninput="checkPaymentFields()">
        </div>
        <div class="form-group">
          <label for="clientEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
          <input type="email" id="clientEmail" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" oninput="checkPaymentFields()">
        </div>
        <div class="form-group">
          <label for="clientPhone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
          <input type="text" id="clientPhone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" oninput="checkPaymentFields()">
        </div>
        <div class="form-group">
          <label for="clientAddress">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
          <textarea id="clientAddress" rows="2" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒØ§Ù…Ù„" oninput="checkPaymentFields()"></textarea>
        </div>
      </div>
      
      <div class="section">
        <h3 class="section-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø©</h3>
        <div class="form-group">
          <label for="invoiceDate">ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ§ØªÙˆØ±Ø©</label>
          <input type="date" id="invoiceDate">
        </div>
        <div class="form-group">
          <label for="dueDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚</label>
          <input type="date" id="dueDate">
        </div>
        <div class="form-group">
          <label for="dealDetails">ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØµÙÙ‚Ø©</label>
          <textarea id="dealDetails" rows="2" placeholder="Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØµÙÙ‚Ø©"></textarea>
        </div>
      </div>
      
      <div class="action-buttons">
        <button class="btn btn-primary" onclick="openTab('items-tab', document.querySelector('.tab[onclick*=&quot;items-tab&quot;]'))">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
      </div>
    </div>
    
    <!-- Ø¨Ù†ÙˆØ¯ Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
    <div id="items-tab" class="tab-content">
      <div class="section">
        <h3 class="section-title">Ø¨Ù†ÙˆØ¯ Ø§Ù„ÙØ§ØªÙˆØ±Ø©
          <button class="btn btn-outline" onclick="addRow()">â• Ø¥Ø¶Ø§ÙØ© Ø³Ø·Ø±</button>
        </h3>
        <table id="itemsTable">
          <thead>
            <tr>
              <th>#</th>
              <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
              <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
              <th>Ø§Ù„Ø³Ø¹Ø±</th>
              <th>Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© %</th>
              <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
              <th>Ø­Ø°Ù</th>
            </tr>
          </thead>
          <tbody id="itemsBody">
            <tr>
              <td>1</td>
              <td><input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ (Ù…Ø·Ù„ÙˆØ¨)" class="product editable-cell" required></td>
              <td><input type="number" class="quantity editable-cell" value="1" min="1" oninput="calculateTotal(this)"></td>
              <td><input type="number" class="price editable-cell" value="0" min="0" step="0.01" oninput="calculateTotal(this)"></td>
              <td><input type="number" class="tax editable-cell" value="0" min="0" max="100" step="0.01" oninput="calculateTotal(this)"></td>
              <td class="lineTotal">0.00</td>
              <td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <div class="totals-section">
        <div class="total-row">
          <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ±Ø¹ÙŠ:</span>
          <span id="subtotal">0.00</span>
        </div>
        <div class="total-row">
          <span>Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©:</span>
          <span id="taxTotal">0.00</span>
        </div>
        <div class="total-row">
          <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</span>
          <span id="grandTotal">0.00</span>
        </div>
      </div>
      
      <div class="action-buttons">
        <button class="btn btn-outline" onclick="openTab('client-tab', document.querySelector('.tab[onclick*=&quot;client-tab&quot;]'))">â† Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
        <button class="btn btn-primary" onclick="openTab('payment-tab', document.querySelector('.tab[onclick*=&quot;payment-tab&quot;]'))">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
      </div>
    </div>
    
    <!-- Ø§Ù„Ø¯ÙØ¹ ÙˆØ§Ù„Ø´Ø­Ù† -->
    <div id="payment-tab" class="tab-content">
      <div class="section" id="paymentSection">
        <h3 class="section-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¯ÙØ¹</h3>
        <div class="form-group">
          <label for="paymentMethod">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label>
          <select id="paymentMethod" onchange="checkPaymentFields()">
            <option value="">Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</option>
            <option value="cash">Ù†Ù‚Ø¯ÙŠ</option>
            <option value="credit">Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†</option>
            <option value="bank">ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ</option>
            <option value="check">Ø´ÙŠÙƒ</option>
          </select>
        </div>
        <div class="form-group">
          <label for="paymentDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙØ¹</label>
          <input type="date" id="paymentDate" onchange="checkPaymentFields()">
        </div>
        <div class="form-group">
          <label for="paymentReference">Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹</label>
          <input type="text" id="paymentReference" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…Ø±Ø¬Ø¹ (Ø¥Ù† ÙˆØ¬Ø¯)" oninput="checkPaymentFields()">
        </div>
      </div>
      
      <div class="section" id="shippingSection">
        <h3 class="section-title">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø­Ù†</h3>
        <div class="form-group">
          <label for="shippingAddress">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø­Ù†</label>
          <textarea id="shippingAddress" rows="2" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø´Ø­Ù†" oninput="checkPaymentFields()"></textarea>
        </div>
        <div class="form-group">
          <label for="shippingMethod">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø´Ø­Ù†</label>
          <select id="shippingMethod" onchange="checkPaymentFields()">
            <option value="">Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø´Ø­Ù†</option>
            <option value="standard">Ø´Ø­Ù† Ø¹Ø§Ø¯ÙŠ</option>
            <option value="express">Ø´Ø­Ù† Ø³Ø±ÙŠØ¹</option>
            <option value="pickup">Ø§Ø³ØªÙ„Ø§Ù… Ù…Ù† Ø§Ù„Ù…ØªØ¬Ø±</option>
          </select>
        </div>
        <div class="form-group">
          <label for="shippingCost">ØªÙƒÙ„ÙØ© Ø§Ù„Ø´Ø­Ù†</label>
          <input type="number" id="shippingCost" value="0" min="0" step="0.01" oninput="updateShipping()">
        </div>
      </div>
      
      <div class="action-buttons">
        <button class="btn btn-outline" onclick="openTab('items-tab', document.querySelector('.tab[onclick*=&quot;items-tab&quot;]'))">â† Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
        <button class="btn btn-primary" onclick="openTab('design-tab', document.querySelector('.tab[onclick*=&quot;design-tab&quot;]'))">Ø§Ù„ØªØ§Ù„ÙŠ â†’</button>
      </div>
    </div>
    
    <!-- Ø§Ù„ØªØµÙ…ÙŠÙ… -->
    <div id="design-tab" class="tab-content">
      <div class="section">
        <h3 class="section-title">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ØªØµÙ…ÙŠÙ…</h3>
        <div class="form-group">
          <label>Ø§Ø®ØªØ± ØªØµÙ…ÙŠÙ… Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</label>
          <div class="theme-selector">
            <div class="theme-option active" style="background: #2c3e50;" onclick="changeTheme('default', this)"></div>
            <div class="theme-option" style="background: #27ae60;" onclick="changeTheme('green', this)"></div>
            <div class="theme-option" style="background: #e74c3c;" onclick="changeTheme('red', this)"></div>
            <div class="theme-option" style="background: #9b59b6;" onclick="changeTheme('purple', this)"></div>
            <div class="theme-option" style="background: #f39c12;" onclick="changeTheme('orange', this)"></div>
          </div>
        </div>
        
        <div class="form-group">
          <label>Ø§Ø®ØªØ± Ù‚Ø§Ù„Ø¨ Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</label>
          <div class="template-selector">
            <div class="template-option active" onclick="selectTemplate('modern', this)">
              <div class="template-preview">Ø­Ø¯ÙŠØ«</div>
              <span>Ù‚Ø§Ù„Ø¨ Ø­Ø¯ÙŠØ«</span>
            </div>
            <div class="template-option" onclick="selectTemplate('classic', this)">
              <div class="template-preview">ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ</div>
              <span>Ù‚Ø§Ù„Ø¨ ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ</span>
            </div>
            <div class="template-option" onclick="selectTemplate('minimal', this)">
              <div class="template-preview">Ø¨Ø³ÙŠØ·</div>
              <span>Ù‚Ø§Ù„Ø¨ Ø¨Ø³ÙŠØ·</span>
            </div>
            <div class="template-option" onclick="selectTemplate('colorful', this)">
              <div class="template-preview">Ù…Ù„ÙˆÙ†</div>
              <span>Ù‚Ø§Ù„Ø¨ Ù…Ù„ÙˆÙ†</span>
            </div>
            <div class="template-option" onclick="selectTemplate('professional', this)">
              <div class="template-preview">Ø§Ø­ØªØ±Ø§ÙÙŠ</div>
              <span>Ù‚Ø§Ù„Ø¨ Ø§Ø­ØªØ±Ø§ÙÙŠ</span>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label for="logoText">Ù†Øµ Ø§Ù„Ø´Ø¹Ø§Ø±:</label>
          <input type="text" id="logoText" value="Ø´" oninput="updateLogo()">
        </div>
        
        <div class="form-group">
          <label for="logoColor">Ù„ÙˆÙ† Ø§Ù„Ø´Ø¹Ø§Ø±:</label>
          <input type="color" id="logoColor" value="#3498db" onchange="updateLogo()">
        </div>
      </div>
      
      <div class="action-buttons">
        <button class="btn btn-outline" onclick="openTab('payment-tab', document.querySelector('.tab[onclick*=&quot;payment-tab&quot;]'))">â† Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
        <button class="btn btn-primary" onclick="openTab('preview-tab', document.querySelector('.tab[onclick*=&quot;preview-tab&quot;]'))">Ù…Ø¹Ø§ÙŠÙ†Ø© â†’</button>
      </div>
    </div>
    
    <!-- Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© -->
    <div id="preview-tab" class="tab-content">
      <div class="section">
        <h3 class="section-title">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©</h3>
        <div class="form-group" style="margin-bottom: 15px;">
          <label for="pageOrientation">Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø©:</label>
          <select id="pageOrientation" onchange="changePageOrientation()" style="max-width: 200px;">
            <option value="portrait">Ø¹Ù…ÙˆØ¯ÙŠ (A4)</option>
            <option value="landscape">Ø£ÙÙ‚ÙŠ (A4)</option>
          </select>
        </div>
        <div class="form-group" style="margin-bottom: 15px;">
          <label for="itemsPerPage">Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø©:</label>
          <input type="number" id="itemsPerPage" value="15" min="5" max="50" style="max-width: 200px;" onchange="updatePageCount()">
          <span id="pageCountDisplay" style="margin-right: 10px; color: var(--secondary); font-weight: bold;"></span>
        </div>
        <div class="invoice-preview" id="invoicePreview">
          <div class="invoice-header-preview">
            <div>
              <h2 id="previewCompanyName">Ø´Ø±ÙƒØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø©</h2>
              <p id="previewCompanyDescription">ÙˆØµÙ Ø´Ø±ÙƒØªÙƒ ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§</p>
              <p id="previewCompanyAddress">Ø¹Ù†ÙˆØ§Ù† Ø´Ø±ÙƒØªÙƒ</p>
              <p id="previewCompanyContact">Ù‡Ø§ØªÙ: 0123456789 | Ø§Ù„Ø¨Ø±ÙŠØ¯: info@company.com</p>
            </div>
            <div>
              <h3>ÙØ§ØªÙˆØ±Ø© #<span id="previewInvoiceNumber">INV-2023-001</span></h3>
              <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: <span id="previewInvoiceDate">-</span></p>
              <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚: <span id="previewDueDate">-</span></p>
            </div>
          </div>
          
          <div class="invoice-details-preview">
            <div>
              <h4>Ø§Ù„Ø¹Ù…ÙŠÙ„:</h4>
              <p id="previewClientName">-</p>
              <p id="previewClientContact">-</p>
              <p id="previewClientAddress">-</p>
            </div>
            <div id="previewPaymentSection" class="hidden-section">
              <h4>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¯ÙØ¹:</h4>
              <p>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹: <span id="previewPaymentMethod">-</span></p>
              <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¯ÙØ¹: <span id="previewPaymentDate">-</span></p>
            </div>
          </div>
          
          <div class="invoice-items-preview">
            <table>
              <thead>
                <tr>
                  <th>#</th>
                  <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                  <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                  <th>Ø§Ù„Ø³Ø¹Ø±</th>
                  <th>Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</th>
                  <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                </tr>
              </thead>
              <tbody id="previewItemsBody">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
              </tbody>
            </table>
          </div>
          
          <div class="invoice-totals-preview">
            <div></div>
            <div>
              <div class="total-row">
                <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ±Ø¹ÙŠ:</span>
                <span id="previewSubtotal">0.00</span>
              </div>
              <div class="total-row">
                <span>Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©:</span>
                <span id="previewTaxTotal">0.00</span>
              </div>
              <div class="total-row">
                <span>Ø§Ù„Ø´Ø­Ù†:</span>
                <span id="previewShipping">0.00</span>
              </div>
              <div class="total-row">
                <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</span>
                <span id="previewGrandTotal">0.00</span>
              </div>
            </div>
          </div>
          
          <div class="print-only">
            <p>Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ¹Ø§Ù…Ù„ÙƒÙ… Ù…Ø¹Ù†Ø§</p>
            <p>Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª: Ù‡Ø§ØªÙ: 0123456789 | Ø§Ù„Ø¨Ø±ÙŠØ¯: info@company.com</p>
          </div>
        </div>
      </div>
      
      <div class="action-buttons">
        <button class="btn btn-outline" onclick="openTab('design-tab', document.querySelector('.tab[onclick*=&quot;design-tab&quot;]'))">â† Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
        <button class="btn btn-success" onclick="saveInvoice()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</button>
        <button class="btn btn-primary" onclick="downloadAsPDF()">ğŸ“„ ØªÙ†Ø²ÙŠÙ„ PDF</button>
        <button class="btn btn-outline" onclick="printInvoice()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
        <button class="btn btn-info" onclick="saveAsImage()">ğŸ“· Ø­ÙØ¸ ÙƒØµÙˆØ±Ø©</button>
        <button class="btn btn-danger" onclick="clearInvoice()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
      </div>
    </div>
    
    <div class="notification" id="notification"></div>
  </div>

  <script>
    // ØªØ¹ÙŠÙŠÙ† ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… ÙƒØªØ§Ø±ÙŠØ® Ø§ÙØªØ±Ø§Ø¶ÙŠ
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('invoiceDate').value = today;
    
    // Ø¥Ø¶Ø§ÙØ© 30 ÙŠÙˆÙ…Ù‹Ø§ Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚
    const dueDate = new Date();
    dueDate.setDate(dueDate.getDate() + 30);
    document.getElementById('dueDate').value = dueDate.toISOString().split('T')[0];
    
    // ÙØªØ­ Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
    function openTab(tabId, eventElement) {
      // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¨ÙˆÙŠØ¨
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
      document.getElementById(tabId).classList.add('active');
      
      // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ø²Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯
      if (eventElement) {
        eventElement.classList.add('active');
      } else {
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨
        document.querySelectorAll('.tab').forEach(tab => {
          if (tab.getAttribute('onclick') && tab.getAttribute('onclick').includes(tabId)) {
            tab.classList.add('active');
          }
        });
      }
      
      // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¹Ù„Ø§Ù…Ø© ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ù„Ø®ØµØŒ Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      if (tabId === 'preview-tab') {
        updatePreview();
      }
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¬Ø¯ÙˆÙ„
    function addRow() {
      const table = document.getElementById("itemsBody");
      const rowCount = table.rows.length + 1;
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${rowCount}</td>
        <td><input type="text" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ (Ù…Ø·Ù„ÙˆØ¨)" class="product editable-cell" required></td>
        <td><input type="number" class="quantity editable-cell" value="1" min="1" oninput="calculateTotal(this)"></td>
        <td><input type="number" class="price editable-cell" value="0" min="0" step="0.01" oninput="calculateTotal(this)"></td>
        <td><input type="number" class="tax editable-cell" value="0" min="0" max="100" step="0.01" oninput="calculateTotal(this)"></td>
        <td class="lineTotal">0.00</td>
        <td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td>
      `;
      table.appendChild(row);
      showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }
    
    // Ù†Ø³Ø® Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø£Ø®ÙŠØ±
    function duplicateLastRow() {
      const table = document.getElementById("itemsBody");
      if (table.rows.length === 0) return;
      
      const lastRow = table.rows[table.rows.length - 1];
      const rowCount = table.rows.length + 1;
      const row = document.createElement("tr");
      
      // Ù†Ø³Ø® Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØµÙ Ø§Ù„Ø£Ø®ÙŠØ±
      const product = lastRow.cells[1].querySelector("input").value;
      const quantity = lastRow.cells[2].querySelector("input").value;
      const price = lastRow.cells[3].querySelector("input").value;
      const tax = lastRow.cells[4].querySelector("input").value;
      
      row.innerHTML = `
        <td>${rowCount}</td>
        <td><input type="text" value="${product}" class="product editable-cell" required></td>
        <td><input type="number" class="quantity editable-cell" value="${quantity}" min="1" oninput="calculateTotal(this)"></td>
        <td><input type="number" class="price editable-cell" value="${price}" min="0" step="0.01" oninput="calculateTotal(this)"></td>
        <td><input type="number" class="tax editable-cell" value="${tax}" min="0" max="100" step="0.01" oninput="calculateTotal(this)"></td>
        <td class="lineTotal">0.00</td>
        <td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td>
      `;
      table.appendChild(row);
      calculateTotal(row.querySelector('.quantity'));
      showNotification('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø£Ø®ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }
    
    // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯
    function clearAllRows() {
      if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯ØŸ')) {
        const itemsBody = document.getElementById('itemsBody');
        itemsBody.innerHTML = '';
        addRow(); // Ø¥Ø¶Ø§ÙØ© ØµÙ ÙØ§Ø±Øº
        updateTotals();
        showNotification('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯', 'success');
      }
    }
    
    // Ø­Ø°Ù Ø³Ø·Ø± Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„
    function deleteRow(button) {
      const row = button.parentElement.parentElement;
      if (document.getElementById("itemsBody").rows.length > 1) {
        row.remove();
        updateRowNumbers();
        updateTotals();
        showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³Ø·Ø± Ø¨Ù†Ø¬Ø§Ø­', 'success');
      } else {
        showNotification('ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¹Ù„Ù‰ Ø³Ø·Ø± ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø£Ø³Ø·Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù
    function updateRowNumbers() {
      const rows = document.querySelectorAll("#itemsBody tr");
      rows.forEach((row, index) => {
        row.cells[0].textContent = index + 1;
      });
    }
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ø³Ø·Ø±
    function calculateTotal(input) {
      const row = input.parentElement.parentElement;
      const quantity = parseFloat(row.querySelector(".quantity").value) || 0;
      const price = parseFloat(row.querySelector(".price").value) || 0;
      const taxRate = parseFloat(row.querySelector(".tax").value) || 0;
      
      const subtotal = quantity * price;
      const taxAmount = subtotal * (taxRate / 100);
      const total = subtotal + taxAmount;
      
      row.querySelector(".lineTotal").textContent = total.toFixed(2);
      updateTotals();
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª (ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø¨Ø¯ÙˆÙ† Ù…Ù†ØªØ¬)
    function updateTotals() {
      let subtotal = 0, taxTotal = 0;
      
      document.querySelectorAll("#itemsBody tr").forEach(row => {
        // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙŠ Ù„Ø§ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬
        const product = row.cells[1].querySelector("input")?.value.trim();
        if (!product) {
          return;
        }
        
        const quantity = parseFloat(row.querySelector(".quantity").value) || 0;
        const price = parseFloat(row.querySelector(".price").value) || 0;
        const taxRate = parseFloat(row.querySelector(".tax").value) || 0;
        
        const lineSubtotal = quantity * price;
        const lineTax = lineSubtotal * (taxRate / 100);
        
        subtotal += lineSubtotal;
        taxTotal += lineTax;
      });
      
      const shippingCost = parseFloat(document.getElementById("shippingCost").value) || 0;
      const grandTotal = subtotal + taxTotal + shippingCost;
      
      document.getElementById("subtotal").textContent = subtotal.toFixed(2);
      document.getElementById("taxTotal").textContent = taxTotal.toFixed(2);
      document.getElementById("grandTotal").textContent = grandTotal.toFixed(2);
      
      // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª
      updatePageCount();
    }
    
    // ØªØ­Ø¯ÙŠØ« ØªÙƒÙ„ÙØ© Ø§Ù„Ø´Ø­Ù†
    function updateShipping() {
      updateTotals();
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¯ÙØ¹ ÙˆØ¥Ø¸Ù‡Ø§Ø±Ù‡Ø§/Ø¥Ø®ÙØ§Ø¤Ù‡Ø§
    function checkPaymentFields() {
      const paymentMethod = document.getElementById("paymentMethod").value;
      const paymentDate = document.getElementById("paymentDate").value;
      const paymentReference = document.getElementById("paymentReference").value;
      const shippingAddress = document.getElementById("shippingAddress").value;
      const shippingMethod = document.getElementById("shippingMethod").value;
      
      const previewPaymentSection = document.getElementById("previewPaymentSection");
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ù‚Ø³Ù… Ø§Ù„Ø¯ÙØ¹ ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª
      if (paymentMethod || paymentDate || paymentReference || shippingAddress || shippingMethod) {
        previewPaymentSection.classList.remove("hidden-section");
      } else {
        previewPaymentSection.classList.add("hidden-section");
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©
    function updatePreview() {
      document.getElementById("previewCompanyName").textContent = 
        document.getElementById("companyName").textContent || 'Ø´Ø±ÙƒØªÙƒ Ø§Ù„Ù…ÙØ¶Ù„Ø©';
      
      document.getElementById("previewCompanyDescription").textContent = 
        document.getElementById("companyDescription").textContent || 'ÙˆØµÙ Ø´Ø±ÙƒØªÙƒ ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§';
      
      document.getElementById("previewCompanyAddress").textContent = 
        document.getElementById("companyAddress").textContent || 'Ø¹Ù†ÙˆØ§Ù† Ø´Ø±ÙƒØªÙƒ';
      
      document.getElementById("previewCompanyContact").textContent = 
        document.getElementById("companyContact").textContent || 'Ù‡Ø§ØªÙ: 0123456789 | Ø§Ù„Ø¨Ø±ÙŠØ¯: info@company.com';
      
      document.getElementById("previewInvoiceNumber").textContent = 
        document.getElementById("invoiceNumberDisplay").textContent;
      
      document.getElementById("previewInvoiceDate").textContent = 
        document.getElementById("invoiceDate").value || '-';
      
      document.getElementById("previewDueDate").textContent = 
        document.getElementById("dueDate").value || '-';
      
      document.getElementById("previewClientName").textContent = 
        document.getElementById("clientName").value || '-';
      
      document.getElementById("previewClientContact").textContent = 
        `${document.getElementById("clientPhone").value || ''} ${document.getElementById("clientEmail").value || ''}`;
      
      document.getElementById("previewClientAddress").textContent = 
        document.getElementById("clientAddress").value || '-';
      
      const paymentMethod = document.getElementById("paymentMethod");
      document.getElementById("previewPaymentMethod").textContent = 
        paymentMethod.options[paymentMethod.selectedIndex].text || '-';
      
      document.getElementById("previewPaymentDate").textContent = 
        document.getElementById("paymentDate").value || '-';
      
      document.getElementById("previewSubtotal").textContent = 
        document.getElementById("subtotal").textContent;
      
      document.getElementById("previewTaxTotal").textContent = 
        document.getElementById("taxTotal").textContent;
      
      document.getElementById("previewShipping").textContent = 
        document.getElementById("shippingCost").value || '0.00';
      
      document.getElementById("previewGrandTotal").textContent = 
        document.getElementById("grandTotal").textContent;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ù†ÙˆØ¯ ÙÙŠ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© (Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø¨Ø¯ÙˆÙ† Ù…Ù†ØªØ¬)
      const previewItemsBody = document.getElementById("previewItemsBody");
      previewItemsBody.innerHTML = '';
      
      let validRowNumber = 1;
      document.querySelectorAll("#itemsBody tr").forEach(row => {
        const product = row.cells[1].querySelector("input")?.value.trim();
        
        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙŠ Ù„Ø§ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬
        if (!product) {
          return;
        }
        
        const quantity = row.cells[2].querySelector("input").value || '0';
        const price = row.cells[3].querySelector("input").value || '0';
        const taxRate = row.cells[4].querySelector("input").value || '0';
        const total = row.cells[5].textContent || '0';
        
        const itemRow = document.createElement("tr");
        itemRow.innerHTML = `
          <td>${validRowNumber}</td>
          <td>${product}</td>
          <td>${quantity}</td>
          <td>${price}</td>
          <td>${taxRate}%</td>
          <td>${total}</td>
        `;
        previewItemsBody.appendChild(itemRow);
        validRowNumber++;
      });
      
      // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª
      updatePageCount();
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ù‚Ø³Ù… Ø§Ù„Ø¯ÙØ¹
      checkPaymentFields();
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
    function updatePageCount() {
      const itemsPerPage = parseInt(document.getElementById('itemsPerPage').value) || 15;
      const validItems = Array.from(document.querySelectorAll("#itemsBody tr")).filter(row => {
        const product = row.cells[1].querySelector("input")?.value.trim();
        return product && product.length > 0;
      });
      const totalItems = validItems.length;
      const totalPages = Math.ceil(totalItems / itemsPerPage);
      const pageCountDisplay = document.getElementById('pageCountDisplay');
      if (pageCountDisplay) {
        pageCountDisplay.textContent = totalPages > 0 ? `(Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª: ${totalPages})` : '(Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ù†ÙˆØ¯)';
      }
    }
    
    // ØªØºÙŠÙŠØ± Ø§Ù„ØªØµÙ…ÙŠÙ…
    function changeTheme(theme, element) {
      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
      document.querySelectorAll('.theme-option').forEach(option => {
        option.classList.remove('active');
      });
      
      // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
      if (element) {
        element.classList.add('active');
      }
      
      // ØªØºÙŠÙŠØ± Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø®ØªØ§Ø±
      const root = document.documentElement;
      switch(theme) {
        case 'green':
          root.style.setProperty('--primary', '#27ae60');
          root.style.setProperty('--secondary', '#2ecc71');
          break;
        case 'red':
          root.style.setProperty('--primary', '#c0392b');
          root.style.setProperty('--secondary', '#e74c3c');
          break;
        case 'purple':
          root.style.setProperty('--primary', '#8e44ad');
          root.style.setProperty('--secondary', '#9b59b6');
          break;
        case 'orange':
          root.style.setProperty('--primary', '#d35400');
          root.style.setProperty('--secondary', '#f39c12');
          break;
        default:
          root.style.setProperty('--primary', '#2c3e50');
          root.style.setProperty('--secondary', '#3498db');
      }
    }
    
    // Ø§Ø®ØªÙŠØ§Ø± Ù‚Ø§Ù„Ø¨ Ø§Ù„ÙØ§ØªÙˆØ±Ø©
    function selectTemplate(template, element) {
      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
      document.querySelectorAll('.template-option').forEach(option => {
        option.classList.remove('active');
      });
      
      // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ø­Ø¯Ø¯
      if (element) {
        element.classList.add('active');
      }
      
      // Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
      const preview = document.getElementById('invoicePreview');
      preview.classList.remove('invoice-template-modern', 'invoice-template-classic', 
                               'invoice-template-minimal', 'invoice-template-colorful', 
                               'invoice-template-professional');
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ù…Ø­Ø¯Ø¯
      preview.classList.add(`invoice-template-${template}`);
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø¹Ø§Ø±
    function updateLogo() {
      const logoText = document.getElementById('logoText').value;
      const logoColor = document.getElementById('logoColor').value;
      
      const logo = document.getElementById('companyLogo');
      logo.textContent = logoText;
      logo.style.background = logoColor;
    }
    
    // Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø©
    function saveInvoice() {
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸
      updatePreview();
      
      // Ø¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø©
      const invoiceData = {
        invoiceNumber: document.getElementById('invoiceNumberDisplay').textContent,
        invoiceDate: document.getElementById('invoiceDate').value,
        dueDate: document.getElementById('dueDate').value,
        pageOrientation: document.getElementById('pageOrientation').value,
        itemsPerPage: parseInt(document.getElementById('itemsPerPage').value) || 15,
        company: {
          name: document.getElementById('companyName').textContent,
          description: document.getElementById('companyDescription').textContent,
          address: document.getElementById('companyAddress').textContent,
          contact: document.getElementById('companyContact').textContent
        },
        client: {
          name: document.getElementById('clientName').value,
          email: document.getElementById('clientEmail').value,
          phone: document.getElementById('clientPhone').value,
          address: document.getElementById('clientAddress').value
        },
        items: [],
        totals: {
          subtotal: document.getElementById('subtotal').textContent,
          tax: document.getElementById('taxTotal').textContent,
          shipping: document.getElementById('shippingCost').value,
          grandTotal: document.getElementById('grandTotal').textContent
        },
        payment: {
          method: document.getElementById('paymentMethod').value,
          date: document.getElementById('paymentDate').value,
          reference: document.getElementById('paymentReference').value
        },
        shipping: {
          address: document.getElementById('shippingAddress').value,
          method: document.getElementById('shippingMethod').value,
          cost: document.getElementById('shippingCost').value
        }
      };
      
      // Ø¬Ù…Ø¹ Ø§Ù„Ø¨Ù†ÙˆØ¯
      document.querySelectorAll("#itemsBody tr").forEach(row => {
        const product = row.cells[1].querySelector("input")?.value.trim();
        if (!product) return; // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø¨Ø¯ÙˆÙ† Ù…Ù†ØªØ¬
        
        invoiceData.items.push({
          product: product,
          quantity: row.cells[2].querySelector("input").value,
          price: row.cells[3].querySelector("input").value,
          tax: row.cells[4].querySelector("input").value,
          total: row.cells[5].textContent
        });
      });
      
      // Ø­ÙØ¸ ÙÙŠ localStorage
      const savedInvoices = JSON.parse(localStorage.getItem('savedInvoices') || '[]');
      savedInvoices.push({
        ...invoiceData,
        savedAt: new Date().toISOString()
      });
      localStorage.setItem('savedInvoices', JSON.stringify(savedInvoices));
      
      // ØªØ­Ù…ÙŠÙ„ ÙƒÙ…Ù„Ù JSON
      const dataStr = JSON.stringify(invoiceData, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `ÙØ§ØªÙˆØ±Ø©-${invoiceData.invoiceNumber}.json`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
      
      showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }
    
    // ØªØºÙŠÙŠØ± Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø©
    function changePageOrientation() {
      const orientation = document.getElementById('pageOrientation').value;
      const preview = document.getElementById('invoicePreview');
      if (orientation === 'landscape') {
        preview.classList.add('landscape');
      } else {
        preview.classList.remove('landscape');
      }
      updatePreview();
    }
    
    // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¥Ù„Ù‰ Ø¹Ø¯Ø© ØµÙØ­Ø§Øª (ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø¨Ø¯ÙˆÙ† Ù…Ù†ØªØ¬)
    function splitInvoiceIntoPages() {
      updatePreview();
      const itemsPerPage = parseInt(document.getElementById('itemsPerPage').value) || 15;
      // ØªØµÙÙŠØ© Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬ ÙÙ‚Ø·
      const validItems = Array.from(document.querySelectorAll("#itemsBody tr")).filter(row => {
        const product = row.cells[1].querySelector("input")?.value.trim();
        return product && product.length > 0;
      });
      const totalItems = validItems.length;
      const totalPages = Math.ceil(totalItems / itemsPerPage);
      
      if (totalPages <= 1) {
        return [validItems];
      }
      
      const pages = [];
      for (let i = 0; i < totalPages; i++) {
        const start = i * itemsPerPage;
        const end = Math.min(start + itemsPerPage, totalItems);
        pages.push(validItems.slice(start, end));
      }
      
      return pages;
    }
    
    // Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙƒØµÙˆØ±Ø©
    function printInvoice() {
      updatePreview();
      showNotification('Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„ØµÙˆØ±Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©...', 'success');
      
      const preview = document.getElementById('invoicePreview');
      
      // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©
      const printMessage = document.createElement('div');
      printMessage.className = 'print-only';
      printMessage.innerHTML = `
        <div style="text-align: center; margin-top: 20px; padding-top: 20px; border-top: 1px solid #ddd;">
          <p>Ø´ÙƒØ±Ø§Ù‹ Ù„ØªØ¹Ø§Ù…Ù„ÙƒÙ… Ù…Ø¹Ù†Ø§</p>
          <p>Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª: ${document.getElementById('companyContact').textContent}</p>
        </div>
      `;
      preview.appendChild(printMessage);
      
      // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¥Ù„Ù‰ ØµÙˆØ±Ø© Ø«Ù… Ø·Ø¨Ø§Ø¹ØªÙ‡Ø§
      setTimeout(() => {
        html2canvas(preview, {
          scale: 2,
          useCORS: true,
          logging: false,
          backgroundColor: '#ffffff',
          width: preview.offsetWidth,
          height: preview.offsetHeight
        }).then(canvas => {
          // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©
          const printWindow = window.open('', '_blank');
          const imgData = canvas.toDataURL('image/png');
          
          printWindow.document.write(`
            <!DOCTYPE html>
            <html>
            <head>
              <title>Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©</title>
              <style>
                @page {
                  size: A4;
                  margin: 0;
                }
                body {
                  margin: 0;
                  padding: 0;
                }
                img {
                  width: 100%;
                  height: auto;
                  display: block;
                }
              </style>
            </head>
            <body>
              <img src="${imgData}" />
            </body>
            </html>
          `);
          
          printWindow.document.close();
          
          setTimeout(() => {
            printWindow.print();
            printWindow.close();
            
            // Ø¥Ø²Ø§Ù„Ø© Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
            if (preview.contains(printMessage)) {
              preview.removeChild(printMessage);
            }
          }, 500);
        }).catch(error => {
          console.error('Error printing:', error);
          showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©', 'error');
          if (preview.contains(printMessage)) {
            preview.removeChild(printMessage);
          }
        });
      }, 500);
    }
    
    // ØªØµØ¯ÙŠØ± Ø¥Ù„Ù‰ PDF
    function exportToPDF() {
      downloadAsPDF();
    }
    
    // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙƒÙ…Ù„Ù PDF ÙƒØµÙˆØ±Ø©
    function downloadAsPDF() {
      updatePreview();
      showNotification('Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± PDF...', 'success');
      
      const { jsPDF } = window.jspdf;
      const orientation = document.getElementById('pageOrientation').value;
      const itemsPerPage = parseInt(document.getElementById('itemsPerPage').value) || 15;
      const isLandscape = orientation === 'landscape';
      
      // ØªÙ‚Ø³ÙŠÙ… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¥Ù„Ù‰ ØµÙØ­Ø§Øª
      const pages = splitInvoiceIntoPages();
      const totalPages = pages.length;
      
      if (totalPages === 0) {
        showNotification('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ù†ÙˆØ¯ ÙÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©', 'error');
        return;
      }
      
      // Ø¥Ù†Ø´Ø§Ø¡ PDF Ø¬Ø¯ÙŠØ¯
      const pdf = new jsPDF({
        orientation: isLandscape ? 'landscape' : 'portrait',
        unit: 'mm',
        format: 'a4',
        compress: true
      });
      
      const pageWidth = isLandscape ? 297 : 210;
      const pageHeight = isLandscape ? 210 : 297;
      
      // Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ±Ø© Ù„ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø©
      function createPageImage(pageIndex, items) {
        return new Promise((resolve, reject) => {
          // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ù…Ø¤Ù‚Øª Ù„Ù„ØµÙØ­Ø©
          const tempDiv = document.createElement('div');
          tempDiv.style.position = 'absolute';
          tempDiv.style.left = '-9999px';
          tempDiv.style.width = isLandscape ? '297mm' : '210mm';
          tempDiv.style.background = 'white';
          tempDiv.style.padding = '30px';
          document.body.appendChild(tempDiv);
          
          // Ù†Ø³Ø® Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙØ§ØªÙˆØ±Ø©
          const preview = document.getElementById('invoicePreview');
          const clonedPreview = preview.cloneNode(true);
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ù†ÙˆØ¯ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
          const itemsBody = clonedPreview.querySelector('#previewItemsBody');
          if (itemsBody) {
            itemsBody.innerHTML = '';
            items.forEach((row, index) => {
              const rowNum = pageIndex * itemsPerPage + index + 1;
              const product = row.cells[1].querySelector("input")?.value || '-';
              const quantity = row.cells[2].querySelector("input").value || '0';
              const price = row.cells[3].querySelector("input").value || '0';
              const taxRate = row.cells[4].querySelector("input").value || '0';
              const total = row.cells[5].textContent || '0';
              
              const itemRow = document.createElement("tr");
              itemRow.innerHTML = `
                <td>${rowNum}</td>
                <td>${product}</td>
                <td>${quantity}</td>
                <td>${price}</td>
                <td>${taxRate}%</td>
                <td>${total}</td>
              `;
              itemsBody.appendChild(itemRow);
            });
          }
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª (ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© ÙÙ‚Ø·)
          if (pageIndex === totalPages - 1) {
            clonedPreview.querySelector('#previewSubtotal').textContent = document.getElementById('subtotal').textContent;
            clonedPreview.querySelector('#previewTaxTotal').textContent = document.getElementById('taxTotal').textContent;
            clonedPreview.querySelector('#previewShipping').textContent = document.getElementById('shippingCost').value || '0.00';
            clonedPreview.querySelector('#previewGrandTotal').textContent = document.getElementById('grandTotal').textContent;
          } else {
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø§Øª ØºÙŠØ± Ø§Ù„Ø£Ø®ÙŠØ±Ø©
            const totalsSection = clonedPreview.querySelector('.invoice-totals-preview');
            if (totalsSection) {
              totalsSection.style.display = 'none';
            }
          }
          
          // Ø¥Ø¶Ø§ÙØ© Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©
          const pageNumDiv = document.createElement('div');
          pageNumDiv.style.textAlign = 'center';
          pageNumDiv.style.marginTop = '20px';
          pageNumDiv.style.fontSize = '12px';
          pageNumDiv.textContent = `ØµÙØ­Ø© ${pageIndex + 1} Ù…Ù† ${totalPages}`;
          clonedPreview.appendChild(pageNumDiv);
          
          tempDiv.appendChild(clonedPreview);
          
          setTimeout(() => {
            html2canvas(clonedPreview, {
              scale: 2,
              useCORS: true,
              logging: false,
              backgroundColor: '#ffffff',
              width: clonedPreview.offsetWidth,
              height: clonedPreview.offsetHeight
            }).then(canvas => {
              const imgData = canvas.toDataURL('image/png');
              
              if (pageIndex > 0) {
                pdf.addPage();
              }
              
              // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ PDF
              pdf.addImage(imgData, 'PNG', 0, 0, pageWidth, pageHeight, undefined, 'FAST');
              
              document.body.removeChild(tempDiv);
              resolve();
            }).catch(error => {
              document.body.removeChild(tempDiv);
              reject(error);
            });
          }, 500);
        });
      }
      
      // Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ± Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
      const promises = [];
      pages.forEach((items, index) => {
        promises.push(createPageImage(index, items));
      });
      
      Promise.all(promises).then(() => {
        // Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù
        const invoiceNumber = document.getElementById('invoiceNumberDisplay').textContent;
        pdf.save(`ÙØ§ØªÙˆØ±Ø©-${invoiceNumber}.pdf`);
        showNotification('ØªÙ… ØªÙ†Ø²ÙŠÙ„ PDF Ø¨Ù†Ø¬Ø§Ø­', 'success');
      }).catch(error => {
        console.error('Error creating PDF:', error);
        showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ PDF', 'error');
      });
    }
    
    // Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙƒØµÙˆØ±Ø© (Ø¹Ø¯Ø© ØµÙØ­Ø§Øª ÙƒØµÙˆØ± Ù…Ù†ÙØµÙ„Ø©)
    function saveAsImage() {
      // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
      const loadingDiv = document.createElement('div');
      loadingDiv.className = 'image-saving';
      loadingDiv.innerHTML = 'Ø¬Ø§Ø±ÙŠ ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¥Ù„Ù‰ ØµÙˆØ±...';
      document.body.appendChild(loadingDiv);
      
      updatePreview();
      
      const itemsPerPage = parseInt(document.getElementById('itemsPerPage').value) || 15;
      const pages = splitInvoiceIntoPages();
      const totalPages = pages.length;
      const invoiceNumber = document.getElementById('invoiceNumberDisplay').textContent;
      
      let completedPages = 0;
      
      // Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ±Ø© Ù„ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø©
      function createPageImage(pageIndex, items) {
        return new Promise((resolve, reject) => {
          // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ù…Ø¤Ù‚Øª Ù„Ù„ØµÙØ­Ø©
          const tempDiv = document.createElement('div');
          tempDiv.style.position = 'absolute';
          tempDiv.style.left = '-9999px';
          tempDiv.style.width = document.getElementById('pageOrientation').value === 'landscape' ? '297mm' : '210mm';
          tempDiv.style.background = 'white';
          tempDiv.style.padding = '30px';
          document.body.appendChild(tempDiv);
          
          // Ù†Ø³Ø® Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ÙØ§ØªÙˆØ±Ø©
          const preview = document.getElementById('invoicePreview');
          const clonedPreview = preview.cloneNode(true);
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨Ù†ÙˆØ¯ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
          const itemsBody = clonedPreview.querySelector('#previewItemsBody');
          if (itemsBody) {
            itemsBody.innerHTML = '';
            items.forEach((row, index) => {
              const rowNum = pageIndex * itemsPerPage + index + 1;
              const product = row.cells[1].querySelector("input")?.value || '-';
              const quantity = row.cells[2].querySelector("input")?.value || '0';
              const price = row.cells[3].querySelector("input")?.value || '0';
              const taxRate = row.cells[4].querySelector("input")?.value || '0';
              const total = row.cells[5].textContent || '0';
              
              const itemRow = document.createElement("tr");
              itemRow.innerHTML = `
                <td>${rowNum}</td>
                <td>${product}</td>
                <td>${quantity}</td>
                <td>${price}</td>
                <td>${taxRate}%</td>
                <td>${total}</td>
              `;
              itemsBody.appendChild(itemRow);
            });
          }
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª (ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© ÙÙ‚Ø·)
          if (pageIndex === totalPages - 1) {
            clonedPreview.querySelector('#previewSubtotal').textContent = document.getElementById('subtotal').textContent;
            clonedPreview.querySelector('#previewTaxTotal').textContent = document.getElementById('taxTotal').textContent;
            clonedPreview.querySelector('#previewShipping').textContent = document.getElementById('shippingCost').value || '0.00';
            clonedPreview.querySelector('#previewGrandTotal').textContent = document.getElementById('grandTotal').textContent;
          } else {
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø§Øª ØºÙŠØ± Ø§Ù„Ø£Ø®ÙŠØ±Ø©
            const totalsSection = clonedPreview.querySelector('.invoice-totals-preview');
            if (totalsSection) {
              totalsSection.style.display = 'none';
            }
          }
          
          // Ø¥Ø¶Ø§ÙØ© Ø±Ù‚Ù… Ø§Ù„ØµÙØ­Ø©
          const pageNumDiv = document.createElement('div');
          pageNumDiv.style.textAlign = 'center';
          pageNumDiv.style.marginTop = '20px';
          pageNumDiv.style.fontSize = '12px';
          pageNumDiv.textContent = `ØµÙØ­Ø© ${pageIndex + 1} Ù…Ù† ${totalPages}`;
          clonedPreview.appendChild(pageNumDiv);
          
          tempDiv.appendChild(clonedPreview);
          
          setTimeout(() => {
            html2canvas(clonedPreview, {
              scale: 2,
          useCORS: true,
          logging: false,
              backgroundColor: '#ffffff',
              width: clonedPreview.offsetWidth,
              height: clonedPreview.offsetHeight
        }).then(canvas => {
              // ØªØ­ÙˆÙŠÙ„ Canvas Ø¥Ù„Ù‰ ØµÙˆØ±Ø©
              const image = canvas.toDataURL('image/png');
              
              // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· ØªØ­Ù…ÙŠÙ„
              const link = document.createElement('a');
              link.href = image;
              link.download = `ÙØ§ØªÙˆØ±Ø©-${invoiceNumber}-ØµÙØ­Ø©-${pageIndex + 1}.png`;
              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
              
              document.body.removeChild(tempDiv);
              completedPages++;
              
              if (completedPages === totalPages) {
                document.body.removeChild(loadingDiv);
                showNotification(`ØªÙ… Ø­ÙØ¸ ${totalPages} ØµÙØ­Ø© ÙƒØµÙˆØ± Ù…Ù†ÙØµÙ„Ø© Ø¨Ù†Ø¬Ø§Ø­`, 'success');
              }
              
              resolve();
        }).catch(error => {
              document.body.removeChild(tempDiv);
              reject(error);
            });
          }, 500);
        });
      }
      
      // Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØ± Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª (Ù…Ø¹ ØªØ£Ø®ÙŠØ± Ø¨ÙŠÙ† ÙƒÙ„ ØµÙˆØ±Ø©)
      pages.forEach((items, index) => {
        setTimeout(() => {
          createPageImage(index, items).catch(error => {
            console.error('Error saving image:', error);
            if (index === pages.length - 1) {
              document.body.removeChild(loadingDiv);
              showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±', 'error');
            }
          });
        }, index * 1000); // ØªØ£Ø®ÙŠØ± Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø© Ø¨ÙŠÙ† ÙƒÙ„ ØµÙˆØ±Ø©
      });
    }
    
    // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function clearInvoice() {
      if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø©ØŸ')) {
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„
        document.getElementById('clientName').value = '';
        document.getElementById('clientEmail').value = '';
        document.getElementById('clientPhone').value = '';
        document.getElementById('clientAddress').value = '';
        document.getElementById('dealDetails').value = '';
        document.getElementById('paymentMethod').value = '';
        document.getElementById('paymentDate').value = '';
        document.getElementById('paymentReference').value = '';
        document.getElementById('shippingAddress').value = '';
        document.getElementById('shippingMethod').value = '';
        document.getElementById('shippingCost').value = '0';
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¬Ø¯ÙˆÙ„
        const itemsBody = document.getElementById('itemsBody');
        itemsBody.innerHTML = '';
        addRow(); // Ø¥Ø¶Ø§ÙØ© ØµÙ ÙØ§Ø±Øº
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('invoiceDate').value = today;
        
        const dueDate = new Date();
        dueDate.setDate(dueDate.getDate() + 30);
        document.getElementById('dueDate').value = dueDate.toISOString().split('T')[0];
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
        updateTotals();
        
        showNotification('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø©', 'success');
      }
    }
    
    // ØªØ¹Ø¨Ø¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
    function fillSampleData() {
      document.getElementById('clientName').value = 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯';
      document.getElementById('clientEmail').value = 'ahmed@example.com';
      document.getElementById('clientPhone').value = '0551234567';
      document.getElementById('clientAddress').value = 'Ø§Ù„Ø±ÙŠØ§Ø¶ØŒ Ø­ÙŠ Ø§Ù„Ø¹Ù„ÙŠØ§ØŒ Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ù„Ùƒ ÙÙ‡Ø¯';
      
      // ØªØ¹Ø¨Ø¦Ø© Ø¨Ø¹Ø¶ Ø§Ù„Ø¨Ù†ÙˆØ¯
      const itemsBody = document.getElementById('itemsBody');
      itemsBody.innerHTML = '';
      
      const sampleItems = [
        {id: 'PRD-001', desc: 'Ù„ÙˆØ­Ø© Ù…ÙØ§ØªÙŠØ­ Ù„Ø§Ø³Ù„ÙƒÙŠØ©', qty: 2, price: 120, tax: 15},
        {id: 'PRD-002', desc: 'Ù…Ø§ÙˆØ³ Ù„Ø§Ø³Ù„ÙƒÙŠ', qty: 2, price: 80, tax: 15},
        {id: 'PRD-003', desc: 'Ø´Ø§Ø´Ø© 24 Ø¨ÙˆØµØ©', qty: 1, price: 800, tax: 15}
      ];
      
      sampleItems.forEach((item, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td><input type="text" value="${item.id}" class="editable-cell"></td>
          <td><input type="text" value="${item.desc}" class="editable-cell"></td>
          <td><input type="number" class="quantity editable-cell" value="${item.qty}" min="1" oninput="calculateTotal(this)"></td>
          <td><input type="number" class="price editable-cell" value="${item.price}" min="0" step="0.01" oninput="calculateTotal(this)"></td>
          <td><input type="number" class="tax editable-cell" value="${item.tax}" min="0" max="100" step="0.01" oninput="calculateTotal(this)"></td>
          <td class="lineTotal">0.00</td>
          <td><button class="delete-btn" onclick="deleteRow(this)">Ã—</button></td>
        `;
        itemsBody.appendChild(row);
        calculateTotal(row.querySelector('.quantity'));
      });
      
      showNotification('ØªÙ… ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©', 'success');
    }
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
    function showNotification(message, type) {
      const notification = document.getElementById("notification");
      notification.textContent = message;
      notification.className = `notification ${type} show`;
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ© Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
    document.getElementById('companyName').addEventListener('input', function() {
      document.getElementById('previewCompanyName').textContent = this.textContent;
    });
    
    document.getElementById('companyDescription').addEventListener('input', function() {
      document.getElementById('previewCompanyDescription').textContent = this.textContent;
    });
    
    document.getElementById('companyAddress').addEventListener('input', function() {
      document.getElementById('previewCompanyAddress').textContent = this.textContent;
    });
    
    document.getElementById('companyContact').addEventListener('input', function() {
      document.getElementById('previewCompanyContact').textContent = this.textContent;
    });
    
    // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    document.getElementById('invoiceDate').addEventListener('change', updatePreview);
    document.getElementById('dueDate').addEventListener('change', updatePreview);
    document.getElementById('clientName').addEventListener('input', updatePreview);
    document.getElementById('clientEmail').addEventListener('input', updatePreview);
    document.getElementById('clientPhone').addEventListener('input', updatePreview);
    document.getElementById('clientAddress').addEventListener('input', updatePreview);
    
    // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Ù†ÙˆØ¯
    document.getElementById('itemsPerPage').addEventListener('input', updatePageCount);
    
    // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø¹Ù†Ø¯ Ø¥Ø¶Ø§ÙØ©/Ø­Ø°Ù/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨Ù†ÙˆØ¯
    const itemsBody = document.getElementById('itemsBody');
    if (itemsBody) {
      const observer = new MutationObserver(() => {
        updatePageCount();
      });
      observer.observe(itemsBody, { childList: true, subtree: true });
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬
    document.addEventListener('input', function(e) {
      if (e.target.classList.contains('editable-cell') && e.target.closest('#itemsBody')) {
        updatePageCount();
        updateTotals();
      }
    });
    
    // ØªØ­Ø¯ÙŠØ« Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨Ø´ÙƒÙ„ Ø£ÙØ¶Ù„
    function generateInvoiceNumber() {
      const year = new Date().getFullYear();
      const month = String(new Date().getMonth() + 1).padStart(2, '0');
      const day = String(new Date().getDate()).padStart(2, '0');
      const random = Math.floor(1000 + Math.random() * 9000);
      return `INV-${year}${month}${day}-${random}`;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    document.getElementById('invoiceNumberDisplay').textContent = generateInvoiceNumber();
    document.getElementById('previewInvoiceNumber').textContent = document.getElementById('invoiceNumberDisplay').textContent;
    
    // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    setTimeout(() => {
      updatePageCount();
    }, 500);
  </script>
</body>
</html>
